# Fedora CoreOS. Мы Федоре не враги

## Аннотация
В докладе будут рассмотрены история возникновения и ключевые особенности дистрибутива «Fedora CoreOS» и его аналогов.
Возможность реализации основных идей дистрибутива в расках операционной системы ALTLinux.


## Текст доклада

При разворачивании решения часто возникает задача разворачивания Linux-кластера серверов в различных средах:
- облачные сервисы: Alibaba, AWS, Azure, DigitalOcean, Exoscale, GCP, Vultr;
- виртуальные машины: QMU/KVN, VMWare, OpenStack;
- "голом" железе.

Как правило, в различных средах разворачиваются различные Linux-дистрибутивы с различными версиями операционных систем, системных библиотек и т.п..
В рамках каждой версии на различных узлах устанавливается различное программное обеспечение (ПО).
Если число узлов в кластере относительно невелико (несколько узлов) администрирование операционных систем (установка обновлений, закрытие уязвимостей, ...) на узлах является небольшой проблемой.
Если же число узлов исчисляется десятками и сотнями, грамотное администрирование разнородных операционных систем с различных установленным ПО становится невозможным.
![Облака](./Images/clouds.png)

`Fedora CoreOS` предлагает решение данной проблемы за счет использования следующих механизмов:
- Исключения участие оператора при разворачивании операционной системы. Для каждого узла в файле конфиграции задаются параметры развертывания (разбиение дисковой подсистемы, конфигурирование сетевых интерфейсов и DNS, настройка сервисов и контейнеров, ...). Установка операционной системы на различные вышеперечисленные платформы производится без участия оператора.
- Автоматическое обновления ядра и операционной системы из одного центра без участия оператора с возможностью приостановить автоматическое обновление и откатить на предыдущую ветку.
- Использование OSTree (git для бинарных файлов) позволяет:
  * откатывать состояние системы на предыдущие коммиты (точки фиксации)
  * разделить файловую систему на неизменяемую (`/usr/`), изменяемую (`/var/`) и обновляемую (`/etc`) части. Что позволяет:
    - упростить обновление бинарного программного кода системы;
    - исключить случайное удаление программного кода;
  * перегружать систему на предыдущие или последующие коммиты.
  * в случае необходимости администратор может, использую утилиту `rpm-ostree`
- Администратор кластера может останавливать часть узлов кластера при снижении нагрузки и восстанавливать их при повышении.
- Весь пользовательский софт работает в контейнерах (podman, moby engine == docker) в различных средах контейнеризации (docker swarm. k8s, ...). Это упрощает обновление системы и исключает изменение функционала пользовательского ПО после обновления системы. 
- Файловая система `Fedora CoreOS` достаточно небольшая (менее `4GB`), что позволяет ее использовать в устройствах `Интернета Вещей`.


### Предшественники

![Предшественники](./Images/parents.png)

- Заимствования из `Container Linux`:
  * Философия
  * Стек поддержки (Provision Stack?)
  * опыт развертывания в облаках различного типа.
- Заимствования из `Atomic Host`:
  * Fedora Foundation;
  * Стек обновления дистрибутива;
  * SeLinux Enhanced Security.

Философия `Container Linux`:

- Атомарные обновления
  * автоматическая установка/обновления без вмешательства оператора;
  * автоматическая синхронизация с последней версией дистрибутива (Bug Fixes).

- Все узлы разворачиваются с одной стартовой точки:

  * использование `ignition` (описание конфигурации узла) при разворачивании и обновлении узла,
    где бы он ни находился  (облачные узлы и узлы на голом железе разворачиваются идентично)

- Неизменная инфрастуктура:
  * Нужны изменения - обновите конфигурация и перегрузитесь.

- Весь пользовательский софт работает в контейнерах, что позволяет более гибко обновлять узлы кластера.

## Список литературы

## Ссылки

- [Fedora CoreOS Introduction - Dusty Mabe (Red Hat)](https://www.youtube.com/watch?v=JepNm7R0LSo)



